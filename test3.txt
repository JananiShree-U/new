
# backend/main.py
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from pydantic import BaseModel

from safety import check_safety

app = FastAPI(title="Safe Chat Backend")

# CORS so React can talk to this API
app.add_middleware(
Â  Â  CORSMiddleware,
Â  Â  allow_origins=["http://localhost:5173", "http://localhost:3000", "*"],
Â  Â  allow_credentials=True,
Â  Â  allow_methods=["*"],
Â  Â  allow_headers=["*"],
)

class ChatRequest(BaseModel):
Â  Â  message: str

class ChatResponse(BaseModel):
Â  Â  reply: str
Â  Â  flagged: bool = False Â  # whether safety triggered

def basic_bot_logic(text: str) -> str:
Â  Â  """
Â  Â  Very simple general Q&A / small-talk logic.
Â  Â  Extend this with your own rules or plug in an LLM later.
Â  Â  """
Â  Â  t = text.lower().strip()

Â  Â  if any(g in t for g in ["hi", "hello", "hey"]):
Â  Â  Â  Â  return "Hey there ğŸ‘‹ How can I help you today?"
Â  Â  if "your name" in t:
Â  Â  Â  Â  return "Iâ€™m a small safe-chat assistant built with FastAPI + React."
Â  Â  if "help" in t:
Â  Â  Â  Â  return (
Â  Â  Â  Â  Â  Â  "You can ask me simple questions, or you can extend my backend "
Â  Â  Â  Â  Â  Â  "to connect to a real AI model or your own knowledge base."
Â  Â  Â  Â  )
Â  Â  if "what can you do" in t:
Â  Â  Â  Â  return "Right now I can chat and demonstrate safety precautions. You can upgrade my brain later ğŸ¤–."

Â  Â  return "Iâ€™m not very smart yet, but you can improve my backend logic anytime!"

@app.post("/chat", response_model=ChatResponse)
async def chat(req: ChatRequest):
Â  Â  user_text = req.message

Â  Â  # 1. Safety check FIRST
Â  Â  flagged, safe_reply = check_safety(user_text)
Â  Â  if flagged:
Â  Â  Â  Â  return ChatResponse(reply=safe_reply, flagged=True)

Â  Â  # 2. Normal bot logic if safe
Â  Â  reply = basic_bot_logic(user_text)
Â  Â  return ChatResponse(reply=reply, flagged=False)

requirements.txt
fastapi
uvicorn[standard]

# safety.py
from typing import Tuple

SELF_HARM_KEYWORDS = [
Â  Â  "kill myself", "suicide", "end my life", "self harm", "hurt myself",
Â  Â  "i want to die", "i am done", "end it all", "cut myself"
]

VIOLENCE_KEYWORDS = [
Â  Â  "kill someone", "hurt others", "murder", "attack", "harm others"
]

def check_safety(text: str) -> Tuple[bool, str]:
Â  Â  t = text.lower().strip()

Â  Â  for k in SELF_HARM_KEYWORDS:
Â  Â  Â  Â  if k in t:
Â  Â  Â  Â  Â  Â  return True, (
Â  Â  Â  Â  Â  Â  Â  Â  "Iâ€™m really sorry you're feeling this way. "
Â  Â  Â  Â  Â  Â  Â  Â  "I can't help with harmful actions, but please consider talking "
Â  Â  Â  Â  Â  Â  Â  Â  "to someone you trust or a trained listener."
Â  Â  Â  Â  Â  Â  )

Â  Â  for k in VIOLENCE_KEYWORDS:
Â  Â  Â  Â  if k in t:
Â  Â  Â  Â  Â  Â  return True, (
Â  Â  Â  Â  Â  Â  Â  Â  "I can't help with anything that harms others. "
Â  Â  Â  Â  Â  Â  Â  Â  "If you're feeling stressed or angry, sharing your thoughts with someone "
Â  Â  Â  Â  Â  Â  Â  Â  "you trust can help."
Â  Â  Â  Â  Â  Â  )

Â  Â  return False, ""

front end

App.css
#root {
Â  max-width: 1280px;
Â  margin: 0 auto;
Â  padding: 2rem;
Â  text-align: center;
}

.logo {
Â  height: 6em;
Â  padding: 1.5em;
Â  will-change: filter;
Â  transition: filter 300ms;
}
.logo:hover {
Â  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
Â  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
Â  from {
Â  Â  transform: rotate(0deg);
Â  }
Â  to {
Â  Â  transform: rotate(360deg);
Â  }
}

@media (prefers-reduced-motion: no-preference) {
Â  a:nth-of-type(2) .logo {
Â  Â  animation: logo-spin infinite 20s linear;
Â  }
}

.card {
Â  padding: 2em;
}

.read-the-docs {
Â  color: #888;
}

// src/App.jsx
import React, { useState } from "react";

const API_URL = "http://localhost:8000/chat";

export default function App() {
Â  const [messages, setMessages] = useState([
Â  Â  {
Â  Â  Â  id: 1,
Â  Â  Â  role: "assistant",
Â  Â  Â  content: "Hi! ğŸ‘‹ Iâ€™m your safe chat assistant. How can I help?",
Â  Â  Â  flagged: false,
Â  Â  },
Â  ]);

Â  const [input, setInput] = useState("");
Â  const [isLoading, setIsLoading] = useState(false);

Â  const sendMessage = async () => {
Â  Â  if (!input.trim()) return;
Â  Â  if (isLoading) return;

Â  Â  const userText = input.trim();

Â  Â  // Add user message
Â  Â  setMessages((prev) => [
Â  Â  Â  ...prev,
Â  Â  Â  { id: Date.now(), role: "user", content: userText, flagged: false },
Â  Â  ]);

Â  Â  setInput("");
Â  Â  setIsLoading(true);

Â  Â  try {
Â  Â  Â  const res = await fetch(API_URL, {
Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  body: JSON.stringify({ message: userText }),
Â  Â  Â  });

Â  Â  Â  const data = await res.json();

Â  Â  Â  setMessages((prev) => [
Â  Â  Â  Â  ...prev,
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  id: Date.now() + 1,
Â  Â  Â  Â  Â  role: "assistant",
Â  Â  Â  Â  Â  content: data.reply,
Â  Â  Â  Â  Â  flagged: data.flagged,
Â  Â  Â  Â  },
Â  Â  Â  ]);
Â  Â  } catch (e) {
Â  Â  Â  console.error("Request to backend failed:", e); // <-- now 'e' is used

Â  Â  Â  setMessages((prev) => [
Â  Â  Â  Â  ...prev,
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  id: Date.now() + 100,
Â  Â  Â  Â  Â  role: "assistant",
Â  Â  Â  Â  Â  content: "âš ï¸ Unable to reach server.",
Â  Â  Â  Â  Â  flagged: false,
Â  Â  Â  Â  },
Â  Â  Â  ]);
Â  Â  } finally {
Â  Â  Â  setIsLoading(false);
Â  Â  }
Â  };

Â  const onKeyPress = (e) => {
Â  Â  if (e.key === "Enter" && !e.shiftKey) {
Â  Â  Â  e.preventDefault();
Â  Â  Â  sendMessage();
Â  Â  }
Â  };

Â  return (
Â  Â  <div className="app-root">
Â  Â  Â  <header className="app-header">
Â  Â  Â  Â  <div className="app-title">
Â  Â  Â  Â  Â  <span className="dot"></span>
Â  Â  Â  Â  Â  Safe Chat UI
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div className="app-subtitle">React + FastAPI</div>
Â  Â  Â  </header>

Â  Â  Â  <div className="notice">
Â  Â  Â  Â  âš ï¸ This assistant avoids harmful content and provides safe responses.
Â  Â  Â  </div>

Â  Â  Â  <div className="chat-box">
Â  Â  Â  Â  <div className="messages">
Â  Â  Â  Â  Â  {messages.map((m) => (
Â  Â  Â  Â  Â  Â  <Message key={m.id} msg={m} />
Â  Â  Â  Â  Â  ))}

Â  Â  Â  Â  Â  {isLoading && (
Â  Â  Â  Â  Â  Â  <div className="message-row assistant">
Â  Â  Â  Â  Â  Â  Â  <div className="avatar assistant-avatar">AI</div>
Â  Â  Â  Â  Â  Â  Â  <div className="bubble assistant-bubble typing">
Â  Â  Â  Â  Â  Â  Â  Â  <span className="dot-anim"></span>
Â  Â  Â  Â  Â  Â  Â  Â  <span className="dot-anim"></span>
Â  Â  Â  Â  Â  Â  Â  Â  <span className="dot-anim"></span>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  )}
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <footer className="input-bar">
Â  Â  Â  Â  <textarea
Â  Â  Â  Â  Â  className="input-box"
Â  Â  Â  Â  Â  placeholder="Type your messageâ€¦"
Â  Â  Â  Â  Â  rows={1}
Â  Â  Â  Â  Â  value={input}
Â  Â  Â  Â  Â  onChange={(e) => setInput(e.target.value)}
Â  Â  Â  Â  Â  onKeyDown={onKeyPress}
Â  Â  Â  Â  />
Â  Â  Â  Â  <button
Â  Â  Â  Â  Â  className="send-btn"
Â  Â  Â  Â  Â  disabled={isLoading || !input.trim()}
Â  Â  Â  Â  Â  onClick={sendMessage}
Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Send
Â  Â  Â  Â  </button>
Â  Â  Â  </footer>
Â  Â  </div>
Â  );
}

function Message({ msg }) {
Â  const isUser = msg.role === "user";
Â  const classBubble = isUser
Â  Â  ? "bubble user-bubble"
Â  Â  : msg.flagged
Â  Â  ? "bubble assistant-bubble flagged"
Â  Â  : "bubble assistant-bubble";

Â  return (
Â  Â  <div className={`message-row ${isUser ? "user" : "assistant"}`}>
Â  Â  Â  <div
Â  Â  Â  Â  className={`avatar ${isUser ? "user-avatar" : "assistant-avatar"}`}
Â  Â  Â  >
Â  Â  Â  Â  {isUser ? "You" : "AI"}
Â  Â  Â  </div>
Â  Â  Â  <div className={classBubble}>{msg.content}</div>
Â  Â  </div>
Â  );
}

Index.css
/* GENERAL LAYOUT */
body {
Â  margin: 0;
Â  background: #0f172a;
Â  color: white;
Â  font-family: system-ui, sans-serif;
Â  height: 100vh;
}

#root {
Â  height: 100%;
}

.app-root {
Â  max-width: 900px;
Â  height: 100%;
Â  margin: auto;
Â  padding: 20px;
Â  display: flex;
Â  flex-direction: column;
}

/* HEADER */
.app-header {
Â  padding: 12px 16px;
Â  border-radius: 16px;
Â  background: rgba(30, 41, 59, 0.9);
Â  display: flex;
Â  justify-content: space-between;
Â  margin-bottom: 12px;
Â  border: 1px solid rgba(100, 116, 139, 0.4);
}

.app-title {
Â  display: flex;
Â  align-items: center;
Â  gap: 8px;
Â  font-weight: 600;
}

.dot {
Â  width: 10px;
Â  height: 10px;
Â  background: #22c55e;
Â  border-radius: 50%;
Â  box-shadow: 0 0 0 6px rgba(34, 197, 94, 0.3);
}

.notice {
Â  background: rgba(51, 65, 85, 0.4);
Â  padding: 10px 12px;
Â  border-radius: 12px;
Â  font-size: 14px;
Â  margin-bottom: 10px;
}

/* CHAT BOX */
.chat-box {
Â  flex: 1;
Â  display: flex;
Â  flex-direction: column;
Â  background: rgba(15, 23, 42, 0.9);
Â  border: 1px solid rgba(71, 85, 105, 0.5);
Â  border-radius: 16px;
Â  padding: 12px;
Â  overflow: hidden;
}

.messages {
Â  flex: 1;
Â  overflow-y: auto;
Â  padding-right: 8px;
}

/* MESSAGE ROW */
.message-row {
Â  display: flex;
Â  gap: 8px;
Â  margin-bottom: 14px;
Â  max-width: 85%;
}

.message-row.user {
Â  margin-left: auto;
Â  flex-direction: row-reverse;
}

/* AVATAR */
.avatar {
Â  width: 30px;
Â  height: 30px;
Â  background: #475569;
Â  border-radius: 50%;
Â  font-size: 12px;
Â  display: flex;
Â  justify-content: center;
Â  align-items: center;
}

.user-avatar {
Â  background: #64748b;
}

.assistant-avatar {
Â  background: linear-gradient(135deg, #22c55e, #0ea5e9);
Â  color: #0f172a;
}

/* BUBBLES */
.bubble {
Â  padding: 10px 14px;
Â  border-radius: 14px;
}

.user-bubble {
Â  background: #4f46e5;
}

.assistant-bubble {
Â  background: #1e293b;
Â  border: 1px solid rgba(148, 163, 184, 0.4);
}

/* SAFETY FLAG */
.flagged {
Â  border-color: gold !important;
Â  box-shadow: 0 0 5px gold;
}

/* TYPING ANIMATION */
.typing .dot-anim {
Â  width: 6px;
Â  height: 6px;
Â  background: #9ca3af;
Â  border-radius: 50%;
Â  margin-right: 4px;
Â  animation: blink 1s infinite ease-in-out alternate;
}

.dot-anim:nth-child(2) {
Â  animation-delay: 0.2s;
}
.dot-anim:nth-child(3) {
Â  animation-delay: 0.4s;
}

@keyframes blink {
Â  from { opacity: 0.3; transform: translateY(3px); }
Â  to { opacity: 1; transform: translateY(-3px); }
}

/* INPUT BAR */
.input-bar {
Â  margin-top: 12px;
Â  display: flex;
Â  gap: 8px;
Â  background: #1e293b;
Â  border: 1px solid #475569;
Â  padding: 10px;
Â  border-radius: 16px;
}

.input-box {
Â  flex: 1;
Â  background: transparent;
Â  border: none;
Â  color: white;
Â  resize: none;
Â  outline: none;
}

.send-btn {
Â  background: linear-gradient(135deg, #22c55e, #0ea5e9);
Â  border: none;
Â  border-radius: 12px;
Â  padding: 10px 16px;
Â  font-weight: 600;
Â  cursor: pointer;
Â  color: #0f172a;
}

.send-btn:disabled {
Â  opacity: 0.4;
}

Main.jsx
// src/main.jsx
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App.jsx";
import "./index.css";

ReactDOM.createRoot(document.getElementById("root")).render(<App />);


Index.html
<!DOCTYPE html>
<html lang="en">
Â  <head>
Â  Â  <meta charset="UTF-8" />
Â  Â  <title>Safe Chat UI</title>
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  </head>
Â  <body>
Â  Â  <div id="root"></div>
Â  Â  <script type="module" src="/src/main.jsx"></script>
Â  </body>
</html>